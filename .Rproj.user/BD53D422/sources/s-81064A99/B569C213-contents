#' @importFrom ggiraph girafeOutput
#' @importFrom shiny tagList includeCSS tags HTML navbarPage tabPanel icon includeMarkdown br p navbarMenu sidebarLayout sidebarPanel uiOutput mainPanel tabsetPanel em h4 downloadButton
#' @importFrom shinydashboard box
#' @importFrom shinythemes shinytheme
#' @importFrom shinyWidgets awesomeCheckbox pickerInput awesomeRadio
#' @importFrom golem activate_js favicon
app_ui <- function() {
  tagList(
    # Leave this function for adding external resources
    golem_add_external_resources(),

    # On inclut du CSS de shinydashboard pour les box 
    includeCSS(path = "www/AdminLTE.css"),
    includeCSS(path = "www/shinydashboard.css"),

    # On modifie le style des notifications (i.e téléchargement)
    tags$style(
      HTML(".shiny-notification {
              height: 50px;
              width: 600px;
              position:fixed;
              top: calc(100% - 80px);;
              left: calc(85% - 350px);;
            }
           "
      )
    ),
    # On modifie manuellement les couleurs acceptées par shiny pour qu'elles collent à IDEA4 
    tags$style(
      type = 'text/css',
      '.bg-lime {background-color: #1CDA53!important; }'),
    tags$style(
      type = 'text/css',
      '.bg-black {background-color: #d6dbe0!important; }'),
    tags$style(
      type = 'text/css',
      '.bg-green {background-color: #0D8A00!important; }'),
    tags$style(
      type = 'text/css',
      '.bg-red {background-color: #FF6348!important; }'),
    tags$style(
      type = 'text/css',
      '.bg-purple {background-color: #469a6b!important; }'),
    tags$style(
      type = 'text/css',
      '.bg-maroon {background-color: #FF0000!important; }'),
    tags$style(type="text/css", "#CGU {color:red}"),
   
    # List the first level UI elements here 
    navbarPage("ShinyIDEA", id = "navar",
               tabPanel("Conditions générales d'utilisation",icon = icon("book-reader"),
                        box(width = 9,includeMarkdown("www/CGU.md")),
                        box(title = "Conditions Générales d'Utilisation",
                            checkboxInput("CGU",HTML("<p style='color:red'> En cochant cette case, je confirme avoir pris connaissance des conditions générales d'utilisation de cet outil et je les accepte.</p>"), width = "100%", value = FALSE),
                            uiOutput("gotoindiv"),
                            br(),
                            uiOutput("gotocollec"),
                            align = "left", width = 3)
                        
               ),
               navbarMenu("Analyse individuelle",icon = icon("user"),menuName = "tab1",
                          "1 - Import",
                          tabPanel("1.1 Import des données et synthèse", value = "indiv",
                                   sidebarLayout(
                                     sidebarPanel(uiOutput("file"), uiOutput("helper1")),
                                     mainPanel(uiOutput("metadata"),uiOutput("synthesis"))
                                   )),
                          "----",
                          "2 - Exploration des résultats",
                          tabPanel("2.1 - Détail des indicateurs",
                                   uiOutput("analyse_indic")),
                          
                          
                          tabPanel("2.2 - Détail des arbres éclairés",
                                   
                                   uiOutput("select_tree"),
                                   uiOutput("tree_show")
                                   
                          ),
                          "----",
                          "3 - Export",
                          tabPanel("3.1 - Télécharger les résultats",
                                   
                                   uiOutput("box_rapport"),
                                   uiOutput("box_zip1")
                                   
                          )
               ),
               navbarMenu("Analyse de groupe",icon = icon("users"),menuName = "tab2",
                          "1 - Import",
                          tabPanel("1.1 - Import des données et synthèse",value = "collec",
                                   sidebarLayout(
                                     sidebarPanel(uiOutput("dir"), uiOutput("helper2")),
                                     mainPanel(uiOutput("carac_grp")
                                     )
                                   )
                          ),
                          "----",
                          "2 - Exploration",
                          tabPanel("2.1 - Statistiques de groupe",
                                   uiOutput("group_dim"),
                                   uiOutput("group_prop")),
                          "----",
                          "3 - Export",
                          tabPanel("3.1 - Télécharger les résultats",
                                   
                                   uiOutput("box_excel"),
                                   
                                   uiOutput("box_zip2")
                                   
                          ))
    )
  )
}

#' @importFrom golem activate_js favicon
#' @importFrom shiny addResourcePath tags
golem_add_external_resources <- function(){
  
  addResourcePath(
    'www', system.file('app/www', package = 'ShinyIDEA')
  )
  
  tags$head(
    golem::activate_js(),
    golem::favicon()
    # Add here all the external resources
    # If you have a custom.css in the inst/app/www
    # Or for example, you can add useShinyalert() here
    #tags$link(rel="stylesheet", type="text/css", href="www/custom.css")
  )
}
